<!DOCTYPE html>
<html lang="zh-hans">

<head>
    
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
<meta name="HandheldFriendly" content="True" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
<meta name="generator" content="Hugo 0.89.2" />



<link rel="apple-touch-icon" sizes="180x180" href="https://cdn.jsdelivr.net/gh/amzrk2/cdn-stcapi@1/favicons/apple-touch-icon.png" />
<link rel="icon" type="image/png" sizes="32x32" href="https://cdn.jsdelivr.net/gh/amzrk2/cdn-stcapi@1/favicons/favicon-32x32.png" />
<link rel="icon" type="image/png" sizes="16x16" href="https://cdn.jsdelivr.net/gh/amzrk2/cdn-stcapi@1/favicons/favicon-16x16.png" />
<link rel="manifest" href="https://cdn.jsdelivr.net/gh/amzrk2/cdn-stcapi@1/favicons/site.webmanifest" />
<link rel="mask-icon" href="https://cdn.jsdelivr.net/gh/amzrk2/cdn-stcapi@1/favicons/safari-pinned-tab.svg" color="#8aa2d3" />
<link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/amzrk2/cdn-stcapi@1/favicons/favicon.ico" />
<meta name="theme-color" content="#ffffff" />


<title>连续时间马尔可夫过程 - 沙雕园</title>


<meta name="author" content="精神病人" />


<meta name="description" content="A minimal Hugo theme with nice theme color." />


<meta name="keywords" content="学习" />


<meta property="og:title" content="连续时间马尔可夫过程" />
<meta name="twitter:title" content="连续时间马尔可夫过程" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://blog.shadiao.online/post/5221-2%E8%BF%9E%E7%BB%AD%E6%97%B6%E9%97%B4%E9%A9%AC%E5%B0%94%E5%8F%AF%E5%A4%AB%E8%BF%87%E7%A8%8B/" /><meta property="og:description" content="泊松过程、生灭过程、更新过程、布朗运动。" />
<meta name="twitter:description" content="泊松过程、生灭过程、更新过程、布朗运动。" /><meta property="og:image" content="https://blog.shadiao.online/img/og.png" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://blog.shadiao.online/img/og.png" /><meta property="article:published_time" content="2021-11-10T13:13:04+08:00" /><meta property="article:modified_time" content="2021-11-10T13:13:04+08:00" />


<style>
    @media (prefers-color-scheme: dark) {
        body[data-theme='auto'] img {
            filter: brightness(60%);
        }
    }

    body[data-theme='dark'] img {
        filter: brightness(60%);
    }
</style>



<link rel="stylesheet" href="https://blog.shadiao.online/assets/css/fuji.min.css" />





</head>

<body data-theme="auto">
    <script data-cfasync="false">
  
  var fujiThemeData = localStorage.getItem('fuji_data-theme');
  
  if (!fujiThemeData) {
    localStorage.setItem('fuji_data-theme', 'auto');
  } else {
    
    if (fujiThemeData !== 'auto') {
      document.body.setAttribute('data-theme', fujiThemeData === 'dark' ? 'dark' : 'light');
    }
  }
</script>
    <header>
    <div class="container-lg clearfix">
        <div class="col-12 header">
            <a class="title-main" href="https://blog.shadiao.online">沙雕园</a>
            
            <span class="title-sub">博客。</span>
            
        </div>
    </div>
</header>

    <main>
        <div class="container-lg clearfix">
            
            <div class="col-12 col-md-9 float-left content">
                
<article>
    
    <h2 class="post-item post-title">
        <a href="https://blog.shadiao.online/post/5221-2%E8%BF%9E%E7%BB%AD%E6%97%B6%E9%97%B4%E9%A9%AC%E5%B0%94%E5%8F%AF%E5%A4%AB%E8%BF%87%E7%A8%8B/">连续时间马尔可夫过程</a>
    </h2>
    <div class="post-item post-meta">
        <span><i class="iconfont icon-today-sharp"></i>&nbsp;2021-11-10</span><span><i class="iconfont icon-file-tray-sharp"></i>&nbsp;3604 字</span><span><i class="iconfont icon-pricetags-sharp"></i>&nbsp;<a href="/tags/%E5%AD%A6%E4%B9%A0">学习</a>&nbsp;</span>

    </div>
    
    <div class="post-content markdown-body">
        <p>泊松过程、生灭过程、更新过程、布朗运动。</p>
<h2 id="泊松过程">泊松过程</h2>
<p>大名鼎鼎的泊松过程定义为满足下式的随机过程：
$$
\begin{gather}
\lim_{h\to 0} P_{k,k+1}(h)=\lambda h,\\
\lim_{h\to 0}P_{k,k}(h)=1-\lambda h,\\
X(0)=0.
\end{gather}
$$
其中 $\lambda&gt;0$ 为参数，称为强度。</p>
<p>性质：</p>
<ul>
<li>
<p>$T_k\sim Exp(\lambda)$，$T_k$ 之间独立</p>
</li>
<li>
<p>$S_n\sim \Gamma(n,\lambda)$，</p>
</li>
<li>
<p>$X(t+u)-X(u)\sim Pois(\lambda t)$，</p>
</li>
<li>
<p>在 $X(t)=n$ 的条件下，$S_1,\cdots,S_n$ 联合分布是均匀分布的次序统计量，具体地，设 $0\le s_1\le\cdots\le s_n\le t$，
$$
P(S_i\le s_i,i=1,\cdots,n|X(t)=n)=\frac{n!}{t^n}\int_{0}^{s_1}\cdots\int_{x_{n-1}}^{x_n}dx_n\cdots dx_1.
$$</p>
</li>
</ul>
<p>这意味着已知某时段发生的事件个数时，事件发生的时间是均匀的。</p>
<p>泊松过程可以推广到两个分支：出生-死亡过程和更新过程，我们一一介绍。</p>
<h2 id="出生-死亡过程">出生-死亡过程</h2>
<p>我们仍然考虑平稳过程。时间连续，状态离散的马尔可夫过程满足
$$
P_{ij}(t)=P{X(t+u)=j|X(u)=i}.
$$
只要给出了这个式子，随机过程就定义好了。</p>
<p>我们先从特殊的过程开始，逐渐推广到一般的出生-死亡过程。我们用 $X(t)$ 表示 $t$ 时刻存活的数量，$T_k$ 表示第 $k$ 个事件和第 $k+1$ 个事件之间的等待时间，$S_k$ 表示第 $k$ 个事件发生时间。具体地，$T_0=0$, $T_k=\inf {t&gt;T_{k-1}:X(t)\ne X(T_{k-1})}$，$S_k=\sum_{i=0}^{k-1}T_i$.</p>
<h3 id="纯出生过程">纯出生过程</h3>
<p>我们推广泊松过程，允许每个事件发生后强度发生变化（也就是“出生率”和“人口数”有关）。设 ${\lambda_k}&gt;0$ 为参数，
$$
\begin{gather}
\lim_{h\to 0} P_{k,k+1}(h)=\lambda_k h,\\
\lim_{h\to 0}P_{k,k}(h)=1-\lambda_k h.\\
\end{gather}
$$
一般来说我们要求 $X(0)=0$，这样比较简洁（也可以令 $X(0)=N$，这不本质）。类似地，可以证明 $T_k$ 之间独立且
$$
T_k\sim Exp(\lambda_k).
$$
于是可以得到 $S_n$ 的特征函数
$$
\varphi_n(t)=\prod_{k=0}^{n-1}\frac{\lambda_k}{\lambda_k-it}.
$$</p>
<h4 id="xt-的分布">$X(t)$ 的分布</h4>
<p>我们来考虑计算 $P_n(t)=P(X(t)=n)$. 利用 $P_0(t+h)=P_0(t)P_0(h)=P_0(t)(1-\lambda_0 h+o(h))$，有
$$
P'<em>0(t)=\lim</em>{h\to 0}\frac{P_0(t+h)-P_0(t)}{h}=\lambda_0P_0(t).
$$
类似地，$P_n(t+h)=P_n(t)P_0(h)+P_{n-1}(t)P_1(h)=P_n(t)(1-\lambda_n h)+P_{n-1}(t)\lambda_{n-1}h+o(h)$, 所以
$$
P'<em>n(t)=\lambda</em>{n-1}P_{n-1}(t)-\lambda_n P_n(t),\quad n\ge 1.
$$
我们得到了齐次线性微分方程组，边界条件 $P_0(0)=1,P_{n}(0)=0,n\ge 1$. 就可以确定下来了。虽然有通用解法，但其实只有特殊情况我们才能写出显式表示，一般情况下只能得到 $P_0(t)=e^{-\lambda_0t}$.</p>
<blockquote>
<p>另一种常用的求分布方法是转化到 $S_n(t)$，我们将在 Yule 过程中用到并在附录介绍。</p>
</blockquote>
<h4 id="yule-过程">Yule 过程</h4>
<p>出生率和人口数成正比，也即 $\lambda_n=n\beta$，$\beta&gt;0$ 为参数。特别地，我们需要假设 $X(0)=N$（否则就一直是0了）。</p>
<blockquote>
<p>如果你实在绕不明白，可以令 $Y(t)=X(t)-N$，这样 $Y(t)$ 就是满足 $Y(0)=0$ 的出生过程了。</p>
</blockquote>
<p>它的分布是
$$
P(X(n)=t)=\binom{n-1}{n-N}e^{-N\beta t}(1-e^{-\beta t})^{n-N},\quad n\ge N.
$$
我们在附录给出推导过程。</p>
<h3 id="出生-死亡过程-1">出生-死亡过程</h3>
<p>来来来，接着推广。现在寿命不是无限的了，还允许死亡。但死亡也要按照基本法：足够短的时间内只能有一个人生或死。这就是出生-死亡过程，其严格定义为同时满足以下几条的随机过程（$\lambda_i,\mu_i$ 为参数）：</p>
<ul>
<li>$\lim_{h\to0} P_{i,i+1}(h)=\lambda_ih$,</li>
<li>$\lim_{h\to0} P_{i,i-1}(h)=\mu_i h,\ i\ge1$,</li>
<li>$\lim_{h\to0} P_{i,i}(h)=(1-\lambda_i-\mu_i)h$,</li>
<li>$P_{ij}(0)=\delta_{ij}$,</li>
<li>$\mu_0=0,\lambda_0&gt;0,\mu_i,\lambda_i&gt;0,i=1,2,\cdots$.</li>
</ul>
<p>我们记初始状态 $P(X(0)=i)=q_i$. 根据 Markov 性，规定了初始状态参数，这个过程就确定了。</p>
<h4 id="xt-的分布-1">$X(t)$ 的分布</h4>
<p>我们可以定义类似于转移矩阵的东西，叫做 infinitesimal generator：
$$
A=\begin{pmatrix}
-\lambda_0 &amp; \lambda_0 &amp; 0 &amp; \cdots\\
\mu_1 &amp; -(\lambda_1+\mu_1) &amp; \lambda_1 &amp; \cdots \\
0 &amp; \mu_2 &amp; -(\lambda_2+\mu_2) &amp; \cdots\\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots
\end{pmatrix}.
$$
若记 $P(h)=(P(X(h)=0),P(X(h)=1),\cdots)$，则有 $P(t+h)=P(t)(I+A)h+o(h)$，于是有齐次线性微分方程组：
$$
\begin{gather}
P'(t)=P(t)A,\\
P(0)=(q_0,q_1,\cdots),
\end{gather}
$$
解微分方程即可确定 $X(t)$ 的分布。</p>
<h4 id="等待时间-t_k">等待时间 $T_k$</h4>
<p>类似地，我们可以得到 $T_k\sim Exp(0,\lambda_k+\mu_k)$.</p>
<h2 id="更新过程">更新过程</h2>
<h3 id="定义">定义</h3>
<p>泊松过程我们让 $T_k$ 是指数分布。如果令 $T_k&gt;0$ 独立同分布，就得到了更新过程。 $X(t)=\sharp{n:0\le S_n\le t}$. <strong>更新函数</strong>定义为 $M(t)=\mathrm EX(t)$. 这是更新过程中一个很重要的东西。</p>
<p>用 $F_n(x)$ 表示 $S_n$ 的分布函数，则满足卷积方程
$$
F_n(x)=\int_0^x F_{n-1}(x-y)dF(y).
$$
可以证明
$$
P(X(t)=k)=F_k(t)-F_{k+1}(t),\quad t\ge0.
$$
并且
$$
M(t)=\sum_{n=1}^\infty F_n(t).
$$
我们有三个比较关心的随机变量：</p>
<ul>
<li>剩余寿命（excess or residual lifetime）：$\gamma_t=S_{N(t)+1}-t$,</li>
<li>年龄（current life / age）：$\delta_t=t-S_{N(t)}$,</li>
<li>总寿命（total life）：$\beta_t=\gamma_t+\delta_t$.</li>
</ul>
<h3 id="更新方程与更新定理">更新方程与更新定理</h3>
<p>这里水很深，有一套专门的更新理论。我们就只介绍关键的定理。</p>
<p>首先可以证明 $M(t)&lt;\infty$，并且有结论
$$
M(t)=F(t)+\int_0^t M(t-y)dF(y).
$$
我们可以定义更一般地更新方程。</p>
<p><strong>定义（更新方程，renewal equation）</strong> 设 $a(t)$ 和 $F(x)$ 已知，如下关于 $A(t)$ 的方程称为更新方程：
$$
A(t)=a(t)+\int_0^t A(t-x)dF(x),\quad t\ge 0.
$$
更新过程的很多问题，最后都会得到一个这样的方程，所以研究它的解很重要。如下几个定理都是围绕更新方程的解展开的。</p>
<p><strong>定理</strong> 设 $a(t)$ 有界，则上述更新方程存在唯一的有限区间内有界的解
$$
A(t)=a(t)+\int_0^t a(t-x)dM(x).
$$
其中 $M(x)=\sum_{n=1}^\infty F_n(x)$ 为更新函数。</p>
<p>下一个定理我们要做一些铺垫。</p>
<p><strong>定义（格点分布，arithmetic）</strong> 随机变量 $X$ 是 arithmetic 的，如果存在 $\lambda&gt;0$ 使得 $\sum_{n\in\mathbb{Z}} P(X=nd)=1$. 此时称 $F$ is arithmetic with span $\lambda$.</p>
<blockquote>
<p>讲义上的定义较为复杂，但说的是一个意思：</p>
<p><strong>定义（point of increase）</strong> 设 $F$ 是分布函数。对 $a\in\mathbb{R}$，如果 $\forall\varepsilon&gt;0$ 都有 $F(a+\varepsilon)-F(a-\varepsilon)&gt;0$，则称 $a$ 点是 a point of increase.</p>
<p>这个定义推广了递增函数的定义，允许在该点崩坏掉。最典型的就是 $X=a$ 的分布函数，$a$ 就是 a point of increase.</p>
<p><strong>定义（arithmetic）</strong> 如果存在 $\lambda$ 使得分布函数 $F$ 在且只在 $0,\pm\lambda,\pm2\lambda,\cdots$ 上 point of increase，则称 $F$ 是 arithmetic 的。</p>
</blockquote>
<p><strong>定义（directly Riemann integrable）</strong> 设 $g:\mathbb{R}^+\to\mathbb{R}$，对 $\delta&gt;0,n=1,2,\cdots$，设</p>
<p>$$
\begin{align}
&amp;\underline{m}_n=\inf{ g(t):(n-1)\delta\le t\le n\delta},\\
&amp;\overline{m}<em>n=\sup{ g(t):(n-1)\delta\le t\le n\delta},\\
&amp;\underline\sigma(\delta)=\delta\sum</em>{n=1}^\infty \underline{m}<em>n,\quad \overline\sigma(\delta)=\delta\sum</em>{n=1}^\infty \overline{m}_n.
\end{align}
$$</p>
<blockquote>
<p>这个公式我怎么编辑它都显示不出，本地明明没问题，我弃疗了……自己在脑中编译一下吧</p>
</blockquote>
<p>若 $\underline\sigma(\delta)$ 和 $\overline\sigma(\delta)$ 对任意的 $\delta&gt;0$ 绝对收敛，且 $\lim_{\delta\to0}\left(\overline\sigma(\delta)-\underline\sigma(\delta)\right)=0$，则称 $g$ directly Riemann integrable.</p>
<blockquote>
<p>注：</p>
<ol>
<li>讲义的定义有瑕疵，应该用 $\inf$ 而不是 $\min$，除非给 $g$ 加别的条件才能保证最大值最小值存在。</li>
<li>这是比黎曼可积更强的条件，因为它要求上和和下和对任意的 $\delta$ 都收敛，而不只是 $\delta\to 0$ 的行为。</li>
</ol>
</blockquote>
<p><strong>定理（Basic renewal theorem）</strong> 设 $F$ 是正随机变量的分布函数，期望为 $\mu$（有限或无限）. 设函数 $a(t),t\ge0$ 是 directly Riemann integrable 的。考虑以下更新方程：
$$
A(t)=a(t)+\int_0^t A(t-x)dF(x),\quad t\ge 0.
$$</p>
<ul>
<li>
<p>若 $F$ 不是 arithmetic 的，则
$$
\lim_{t\to\infty} A(t)=\left{
\begin{align}
&amp;\frac{1}{\mu}\int_0^\infty a(x)dx,&amp;\text{若 }\mu&lt;\infty,\\
&amp;0,&amp;\text{若 }\mu=\infty.
\end{align}
\right.
$$</p>
</li>
<li>
<p>若 $F$ is arithmetic with span $\lambda$，则 $\forall 0\le c\le \lambda$，
$$
\lim_{n\to\infty} A(c+n\lambda)=\left{
\begin{align}
&amp;\frac{\lambda}{\mu}\sum_{n=0}^\infty a(c+n\lambda),&amp;\text{若 }\mu&lt;\infty,\\
&amp;0,&amp;\text{若 }\mu=\infty.
\end{align}
\right.
$$</p>
</li>
<li></li>
</ul>
<p>设 $h&gt;0$，如果令 $a(y)=I(0\le y&lt; h)$，稍加分析可以得到下面有关更新过程的结论。</p>
<p><strong>定理</strong> 设 $F$ 是正随机变量的分布函数，期望为 $\mu$，设 $M(t)=\sum_{k=1}^\infty F_k(t)$，$h&gt;0$，则</p>
<ul>
<li>
<p>若 $F$ 不是 arithmetic 的，则
$$
\lim_{t\to\infty}(M(t+h)-M(t))=\frac{h}{\mu}.
$$</p>
</li>
<li>
<p>若 $F$ is arithmetic with span $\lambda$，当 $h$ 是 $\lambda$ 的整数倍时上述结论成立。</p>
</li>
</ul>
<p>上述定理可以推出如下初等更新定理。</p>
<p><strong>定理（初等更新定理，Elementary renewal theorem）</strong> 令 ${X_i}$ 是更新过程，$\mu=\mathrm EX_1&lt;\infty$，则
$$
\lim_{t\to\infty}\frac{1}{t}M(t)=\frac{1}{\mu}.
$$
它表明更新函数增长速度恰好是时间间隔的倒数，非常直观。</p>
<h2 id="布朗运动">布朗运动</h2>
<p>考虑时间连续、状态连续的马尔可夫过程。记 $p(x,t|x_0)$ 为条件分布 $X(t+t_0)|X(t_0)=x_0$ 的概率密度函数。只要确定了 $X(0)$ 的分布和 $p(x,t|x_0)$，这个马尔可夫过程就唯一确定了。</p>
<p>一维布朗运动的定义是：</p>
<ul>
<li>$X(t+s)-X(s)\sim N(0,\sigma^2 t)$（通常令 $\sigma^2=1$）,</li>
<li>$\forall t_1&lt;t_2&lt;t_3&lt;t_4$, $X(t_4)-X(t_3)$ 和 $X(t_2)-X(t_1)$ 独立,</li>
<li>$X(0)=0$. 轨道函数 $X(t)$ 在 $t=0$ 处连续。</li>
</ul>
<p>显然其转移概率是
$$
p(x,t|x_0)=\frac{1}{\sqrt{2\pi t}\sigma}e^{-(x-x_0)^2/(2\sigma^2 t)}.
$$
<strong>定理</strong> 对 $t_1&lt;t&lt;t_2$，给定 $X(t_1)=A,X(t_2)=B$ 时 $X(t)$ 的条件分布服从 $N\left(A+\dfrac{B-A}{t_2-t_1},\dfrac{(t_2-t)(t-t_1)}{t_2-t_1}\right)$. 证明略。</p>
<p><strong>首达时间</strong> $T_a$ 定义为 $X(0)=0$ 时第一次到达 $a$ 的时间。我们有结论
$$
f_{T_a}(t)=\frac{a}{\sqrt{2\pi}}t^{-3/2}e^{-a^2/(2t)}.
$$
其推导见附录。利用此结论，我们可以得到下面的定理。</p>
<p>**定理 ** 轨道 $X(t)$ 在 $(t_0,t_1)$ 内有至少一个 0 的概率是
$$
\alpha=\frac{2}{\pi}\arccos\sqrt{\frac{t_0}{t_1}}.
$$</p>
<h2 id="附录">附录</h2>
<h3 id="yule-过程求-pxtn">Yule 过程求 $P(X(t)=n)$</h3>
<p>讲义通过解微分方程求的，但那个微分方程按照一般流程计算极其复杂，多少需要一点目测猜解的功力。我们这里给出基于 $S_n$ 密度函数的推导，大力出奇迹即可。</p>
<p>令 $Y(t)=X(t)-N$，则 $Y(t)$ 为纯出生过程，$\lambda_k=(N+k)\beta$. 我们先利用特征函数来求 $S_n$ 的密度函数 $f_{S_n}$，即
$$
\begin{align}
f_{S_n}(x)&amp;=\frac{1}{2\pi}\int_{-\infty}^\infty e^{-itx}\prod_{k=0}^{n-1}\frac{(N+k)\beta}{(N+k)\beta-it}dt.\\
\end{align}
$$
记上面被积函数为 $g(t),t\in\mathbb{C}$. 其有 $n$ 个奇点，为 $t_k=-i(N+k)\beta,\ k=0,\cdots,n-1$. 留数为
$$
\begin{align}
Res(g,t_k)&amp;=\frac{1}{-i}e^{-(N+k)\beta x}(-1)^k\frac{(N+n-1)!}{(N-1)!(n-1-k)!k!}\beta\\
&amp;=i\beta\frac{(N+n-1)!}{(N-1)!(n-1)!}e^{-N\beta x}(1-e^{-\beta x})^{n-1}.
\end{align}
$$
于是
$$
\begin{align}
\sum_{k=0}^{n-1}Res(g,t_k)&amp;=i\beta\frac{(N+n-1)!}{(N-1)!(n-1)!}e^{-N\beta x}\sum_{k=0}^{n-1}(-1)^k\binom{n-1}{k}e^{-k\beta x}\\
&amp;=i\beta n\binom{N+n-1}{N-1}e^{-N\beta x}(1-e^{-\beta x})^{n-1}.
\end{align}
$$</p>
<p>设路径 $L_1$ 为沿实轴 $-r$ 到 $r$，$L_2$ 为下半圆 $re^{i\theta},\pi\le\theta\le 2\pi$. 当 $r$ 充分大时，利用留数定理，
$$
\begin{align}
\int_{-L_1+L_2}g(z)dz&amp;=2\pi i\sum_{k=0}^{n-1} Res(g,t_k).\\
\end{align}
$$
令 $r\to\infty$，得
$$
\begin{align}
f_{S_n}(x)&amp;=-\int_{L_2}g(z)dz\\
&amp;=\beta n\binom{N+n-1}{N-1}e^{-N\beta x}(1-e^{-\beta x})^{n-1}.\\
\end{align}
$$
然后可以办正事了，
$$
\begin{align}
P(Y(t)=n)&amp;=P(S_n\le t&lt; S_{n+1})\\
&amp;=\int_0^t P(S_n\le t &lt;S_{n+1}|S_n=x)f_{S_n}(x)dx\\
&amp;=\int_0^t P(T_n&gt;t-x)f_{S_n}(x)dx\\
&amp;=\int_0^t e^{-(N+n)\beta (t-x)}\beta n\binom{N+n-1}{N-1}e^{-N\beta x}(1-e^{-\beta x})^{n-1}dx\\
&amp;=\beta n\binom{N+n-1}{N-1}e^{-(N+n)\beta t}\int_0^t e^{n\beta x}(1-e^{-\beta x})^{n-1}dx.
\end{align}
$$
设上面最后一步积分为 $I$. 令 $y=e^{\beta x}$，有
$$
I=\int_1^{e^{\beta t}}y^n(1-\frac{1}{y})^{n-1}\frac{1}{\beta y}dy=\frac{1}{n\beta}(e^{\beta t}-1)^n.
$$
于是
$$
P(Y(t)=n)=\binom{N+n-1}{N-1}e^{-N\beta t}(1-e^{-\beta t})^{n}.
$$
终于，
$$
P(X(t)=n)=P(Y(t)=n-N)=\binom{n-1}{N-1}e^{-N\beta t}(1-e^{-\beta t})^{n-N}.
$$</p>
<blockquote>
<p>所以说，本科的基础课都好好学，早晚会用上的…… 不说了，我接着复习复分析去了……</p>
</blockquote>
<h3 id="布朗运动首达时间">布朗运动首达时间</h3>
<p>感觉 lecture notes 写的不是很清楚。首先有
$$
P(T_a\le t)=P(\max_{0\le u\le t} X(u)\ge a).
$$
然后考虑样本轨道集合 $A={X(u):\max_{0\le u\le t} X(u)\ge a}$. 对 $A$ 中每个轨道 $X(u)$，记首次达到 $a$ 的时刻为 $\tau&lt;t$，考虑反射
$$
\tilde X(t)=\left{
\begin{align}
&amp;X(t)\qquad &amp; t &lt;\tau,\\
&amp;a-[x(t)-a]\qquad &amp;t&gt;\tau.
\end{align}
\right.
$$
如果 $X(t)&gt;a$，则 $\tilde X(t)&lt;a$，反之亦然，所以 $P(\max_{0\le u\le t} X(u)\ge a)=2P(X(t)&gt; a)$. 然后就好算了。</p>
    </div>
</article>



<div class="post-comment" data-comment="utterances">
    
    
    <script src="https://utteranc.es/client.js"
        repo="jcq15/blog"
        issue-term="title"
        theme="github-light"
        crossorigin="anonymous"
        async>
    </script>
</div>


            </div>
            <aside class="col-12 col-md-3 float-left sidebar">
    
    <div class="sidebar-item sidebar-pages">
        <h3>页面</h3>
        <ul>
            
            <li>
                <a href="/">主页</a>
            </li>
            
            <li>
                <a href="/archives/">文章</a>
            </li>
            
            <li>
                <a href="/about/">关于</a>
            </li>
            
            <li>
                <a href="/index.xml">RSS</a>
            </li>
            
        </ul>
    </div>
    
    <div class="sidebar-item sidebar-links">
        <h3>链接</h3>
        <ul>
            
            <li>
                <a href="https://github.com/jcq15" target="_blank"><span>GitHub</span></a>
            </li>
            
        </ul>
    </div>
    
    <div class="sidebar-item sidebar-tags">
        <h3>标签</h3>
        <div>
            
            <span>
                <a href="/tags/%E5%AD%A6%E4%B9%A0/">学习</a>
            </span>
            
            <span>
                <a href="/tags/%E6%8A%80%E6%9C%AF/">技术</a>
            </span>
            
            <span>
                <a href="/tags/%E6%B2%99%E9%9B%95/">沙雕</a>
            </span>
            
            <span>
                <a href="/tags/%E6%B8%B8%E6%88%8F/">游戏</a>
            </span>
            
            <span>
                <a href="/tags/%E7%A7%91%E6%99%AE/">科普</a>
            </span>
            
            <span>
                <a href="/tags/%E7%BB%8F%E9%AA%8C%E5%88%86%E4%BA%AB/">经验分享</a>
            </span>
            
        </div>
    </div>
    <div class="sidebar-item sidebar-toc">
        <h3>目录</h3><nav id="TableOfContents">
  <ul>
    <li><a href="#泊松过程">泊松过程</a></li>
    <li><a href="#出生-死亡过程">出生-死亡过程</a>
      <ul>
        <li><a href="#纯出生过程">纯出生过程</a></li>
        <li><a href="#出生-死亡过程-1">出生-死亡过程</a></li>
      </ul>
    </li>
    <li><a href="#更新过程">更新过程</a>
      <ul>
        <li><a href="#定义">定义</a></li>
        <li><a href="#更新方程与更新定理">更新方程与更新定理</a></li>
      </ul>
    </li>
    <li><a href="#布朗运动">布朗运动</a></li>
    <li><a href="#附录">附录</a>
      <ul>
        <li><a href="#yule-过程求-pxtn">Yule 过程求 $P(X(t)=n)$</a></li>
        <li><a href="#布朗运动首达时间">布朗运动首达时间</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
</aside>
        </div>
        <div class="btn">
    <div class="btn-menu" id="btn-menu">
        <i class="iconfont icon-grid-sharp"></i>
    </div>
    <div class="btn-toggle-mode">
        <i class="iconfont icon-contrast-sharp"></i>
    </div>
    <div class="btn-scroll-top">
        <i class="iconfont icon-chevron-up-circle-sharp"></i>
    </div>
</div>
<aside class="sidebar-mobile" style="display: none;">
  <div class="sidebar-wrapper">
    
    <div class="sidebar-item sidebar-pages">
        <h3>页面</h3>
        <ul>
            
            <li>
                <a href="/">主页</a>
            </li>
            
            <li>
                <a href="/archives/">文章</a>
            </li>
            
            <li>
                <a href="/about/">关于</a>
            </li>
            
            <li>
                <a href="/index.xml">RSS</a>
            </li>
            
        </ul>
    </div>
    
    <div class="sidebar-item sidebar-links">
        <h3>链接</h3>
        <ul>
            
            <li>
                <a href="https://github.com/jcq15" target="_blank"><span>GitHub</span></a>
            </li>
            
        </ul>
    </div>
    
    <div class="sidebar-item sidebar-tags">
        <h3>标签</h3>
        <div>
            
            <span>
                <a href="/tags/%E5%AD%A6%E4%B9%A0/">学习</a>
            </span>
            
            <span>
                <a href="/tags/%E6%8A%80%E6%9C%AF/">技术</a>
            </span>
            
            <span>
                <a href="/tags/%E6%B2%99%E9%9B%95/">沙雕</a>
            </span>
            
            <span>
                <a href="/tags/%E6%B8%B8%E6%88%8F/">游戏</a>
            </span>
            
            <span>
                <a href="/tags/%E7%A7%91%E6%99%AE/">科普</a>
            </span>
            
            <span>
                <a href="/tags/%E7%BB%8F%E9%AA%8C%E5%88%86%E4%BA%AB/">经验分享</a>
            </span>
            
        </div>
    </div>
    
    
    
    <div class="sidebar-item sidebar-toc">
        <h3>目录</h3>
        <nav id="TableOfContents">
  <ul>
    <li><a href="#泊松过程">泊松过程</a></li>
    <li><a href="#出生-死亡过程">出生-死亡过程</a>
      <ul>
        <li><a href="#纯出生过程">纯出生过程</a></li>
        <li><a href="#出生-死亡过程-1">出生-死亡过程</a></li>
      </ul>
    </li>
    <li><a href="#更新过程">更新过程</a>
      <ul>
        <li><a href="#定义">定义</a></li>
        <li><a href="#更新方程与更新定理">更新方程与更新定理</a></li>
      </ul>
    </li>
    <li><a href="#布朗运动">布朗运动</a></li>
    <li><a href="#附录">附录</a>
      <ul>
        <li><a href="#yule-过程求-pxtn">Yule 过程求 $P(X(t)=n)$</a></li>
        <li><a href="#布朗运动首达时间">布朗运动首达时间</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
    
    
  </div>
</aside>
    </main>

    <footer>
    <div class="container-lg clearfix">
        <div class="col-12 footer">
            
            <p>
                除特殊注明部分，本站内容采用 <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 进行许可。
            </p>
            
            <span>&copy; 2021-2021
                <a href="https://blog.shadiao.online">精神病人</a>
                 | <a href="https://github.com/jcq15/blog">Source code</a> 
                | 基于 <a href="https://github.com/dsrkafuu/hugo-theme-fuji/"
                   target="_blank">Fuji-v2</a> &amp; <a href="https://gohugo.io/"
                                                    target="_blank">Hugo</a> 构建
            </span>
        </div>
    </div>
</footer>

    
<script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.0/lazysizes.min.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/components/prism-core.min.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/autoloader/prism-autoloader.min.js"></script>



<script defer src="/assets/js/fuji.min.js"></script>


<script>
  MathJax = {
    tex: {
      inlineMath: [["$", "$"]],
    },
    displayMath: [
      ["$$", "$$"],
      ["\[\[", "\]\]"],
    ],
    svg: {
      fontCache: "global",
    },
  };
</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script
  id="MathJax-script"
  async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"
></script>



</body>

</html>