<!DOCTYPE html>
<html lang="zh-hans">

<head>
    
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
<meta name="HandheldFriendly" content="True" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
<meta name="generator" content="Hugo 0.81.0" />



<link rel="apple-touch-icon" sizes="180x180" href="https://cdn.jsdelivr.net/gh/amzrk2/cdn-stcapi@1/favicons/apple-touch-icon.png" />
<link rel="icon" type="image/png" sizes="32x32" href="https://cdn.jsdelivr.net/gh/amzrk2/cdn-stcapi@1/favicons/favicon-32x32.png" />
<link rel="icon" type="image/png" sizes="16x16" href="https://cdn.jsdelivr.net/gh/amzrk2/cdn-stcapi@1/favicons/favicon-16x16.png" />
<link rel="manifest" href="https://cdn.jsdelivr.net/gh/amzrk2/cdn-stcapi@1/favicons/site.webmanifest" />
<link rel="mask-icon" href="https://cdn.jsdelivr.net/gh/amzrk2/cdn-stcapi@1/favicons/safari-pinned-tab.svg" color="#8aa2d3" />
<link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/amzrk2/cdn-stcapi@1/favicons/favicon.ico" />
<meta name="theme-color" content="#ffffff" />


<title>Python 速查表 - 沙雕园</title>


<meta name="author" content="精神病人" />


<meta name="description" content="A minimal Hugo theme with nice theme color." />


<meta name="keywords" content="技术" />


<meta property="og:title" content="Python 速查表" />
<meta name="twitter:title" content="Python 速查表" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://blog.shadiao.online/post/python/" /><meta property="og:description" content="我们经常会用到 Python 的各种库，坠痛苦的就是有一些实用的命令记不住，用的时候只好现查，而且这个效率 efficiency…… 所以啊，我整了这么个速查表，以后直接在这里找就好了。" />
<meta name="twitter:description" content="我们经常会用到 Python 的各种库，坠痛苦的就是有一些实用的命令记不住，用的时候只好现查，而且这个效率 efficiency…… 所以啊，我整了这么个速查表，以后直接在这里找就好了。" /><meta property="og:image" content="https://blog.shadiao.online/img/og.png" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://blog.shadiao.online/img/og.png" /><meta property="article:published_time" content="2021-02-22T21:13:04+08:00" /><meta property="article:modified_time" content="2021-02-22T21:13:04+08:00" />


<style>
    @media (prefers-color-scheme: dark) {
        body[data-theme='auto'] img {
            filter: brightness(60%);
        }
    }

    body[data-theme='dark'] img {
        filter: brightness(60%);
    }
</style>



<link rel="stylesheet" href="https://blog.shadiao.online/assets/css/fuji.min.css" />





</head>

<body data-theme="auto">
    <script data-cfasync="false">
  
  var fujiThemeData = localStorage.getItem('fuji_data-theme');
  
  if (!fujiThemeData) {
    localStorage.setItem('fuji_data-theme', 'auto');
  } else {
    
    if (fujiThemeData !== 'auto') {
      document.body.setAttribute('data-theme', fujiThemeData === 'dark' ? 'dark' : 'light');
    }
  }
</script>
    <header>
    <div class="container-lg clearfix">
        <div class="col-12 header">
            <a class="title-main" href="https://blog.shadiao.online">沙雕园</a>
            
            <span class="title-sub">博客。</span>
            
        </div>
    </div>
</header>

    <main>
        <div class="container-lg clearfix">
            
            <div class="col-12 col-md-9 float-left content">
                
<article>
    
    <h2 class="post-item post-title">
        <a href="https://blog.shadiao.online/post/python/">Python 速查表</a>
    </h2>
    <div class="post-item post-meta">
        <span><i class="iconfont icon-today-sharp"></i>&nbsp;2021-02-22</span><span><i class="iconfont icon-file-tray-sharp"></i>&nbsp;2245 字</span><span><i class="iconfont icon-pricetags-sharp"></i>&nbsp;<a href="/tags/%E6%8A%80%E6%9C%AF">技术</a>&nbsp;</span>

    </div>
    
    <div class="post-content markdown-body">
        <p>我们经常会用到 Python 的各种库，坠痛苦的就是有一些实用的命令记不住，用的时候只好现查，而且这个效率 efficiency…… 所以啊，我整了这么个速查表，以后直接在这里找就好了。</p>
<p>本贴会持续更新~</p>
<blockquote>
<p>注意：本文不是教程，而是速查表。</p>
</blockquote>
<h2 id="实用工具">实用工具</h2>
<h3 id="datetime">datetime</h3>
<pre><code class="language-python">import datetime
</code></pre>
<p><a href="https://docs.python.org/zh-cn/3/library/datetime.html" target="_blank">官方文档：https://docs.python.org/zh-cn/3/library/datetime.html</a></p>
<p>日期和时间均用datetime.datetime类的对象表示，所以我们先介绍该类的方法</p>
<pre><code class="language-python">now = datetime.datetime.now()       # 当前时间，类型：datetime.datetime
now.year                            # 获取年（int）
now.month                           # 月
# 类似地还有：day, hour, minute, second, microsecond
</code></pre>
<p>datetime与字符串之间的转化</p>
<pre><code class="language-python"># datetime到字符串用strftime（f是format的意思）
now.strftime('%Y-%m-%d %H:%M:%S')   # '2020-09-02 17:45:18'，注意大小写
# 字符串到datetime用strptime
datetime.datetime.strptime('2020-09-02 17:45:18', '%Y-%m-%d %H:%M:%S')
# 这个方法很灵活，根据实际情况来写就行，比如你拿到的数据是'2020年9.2'
str_time = '2020年9.2'
datetime.datetime.strptime(str_time, '%Y年%m.%d') # 就可以正确生成
# 除了%Y，%m这些，还有许多其他类型的代码，完整格式代码请查看https://docs.python.org/zh-cn/3/library/datetime.html#strftime-and-strptime-format-codes 
</code></pre>
<p>时间差</p>
<pre><code class="language-python"># timedelta类用来处理时间差
a = datetime.datetime.strptime('2020-09-02 17:45:18', '%Y-%m-%d %H:%M:%S')
b = datetime.datetime.strptime('2020-09-03 17:46:18', '%Y-%m-%d %H:%M:%S')
delta = b - a                        # 返回timedelta对象
delta.days                           # 1
delta.seconds                        # 60
# 注意只有 days. seconds 和 microseconds 会存储在内部，days=1，seconds=60表示这个时间差是1天零60秒，这个结果是唯一的，seconds满一天会自动进位，所以并不会出现days=0，seconds=86460这种情况。
</code></pre>
<h2 id="数据处理">数据处理</h2>
<h3 id="numpy">numpy</h3>
<p>这部分主要整理自 <a href="https://cs231n.github.io/python-numpy-tutorial/">https://cs231n.github.io/python-numpy-tutorial/</a></p>
<p>This tutorial was originally contributed by Justin Johnson</p>
<h4 id="创建">创建</h4>
<p>numpy 的核心是 array，它可以表示高维张量，包括向量（rank=1）、矩阵（rank=2）、三阶张量（rank=3）等。我们有很多种方法创建 array：</p>
<pre><code class="language-python">import numpy as np

a = np.array([1, 2, 3])                  # 通过list创建array
b = np.array([1, 2, 3], [4, 5, 6])       # rank=2，矩阵
print(b)
# [[1 2 3]
#  [4 5 6]]
c = np.zeros((2, 2))                     # 创建2*2的全0矩阵
d = np.ones((1, 2))                      # 1*2的全1矩阵
e = np.full((2, 2), 7)                   # 2*2，元素都是7
f = np.eye(2)                            # 2*2单位矩阵
g = np.random.random((2, 2))             # 2*2随机矩阵
</code></pre>
<h4 id="索引与切片">索引与切片</h4>
<p>可使用list作为下标进行索引，并且支持与python类似的切片操作。</p>
<p><strong>与list不同的是，array的切片操作返回的是引用，因此修改切片后的值会修改原array的值！</strong></p>
<pre><code class="language-python"># Create the following rank 2 array with shape (3, 4)
# [[ 1  2  3  4]
#  [ 5  6  7  8]
#  [ 9 10 11 12]]
a = np.array([[1,2,3,4], [5,6,7,8], [9,10,11,12]])
b = a[:2, 1:3]
# [[2 3]
#  [6 7]]
</code></pre>
<p>如果某一维度的索引是 int，array会进行降维。要想避免降维可以使用单个元素的 list：</p>
<pre><code class="language-python">row_r1 = a[1, :]    # 矩阵惨遭降维成向量 
row_r2 = a[1:2, :]  # 如果把1改成1：2，虽然数据一样，但是不降维
row_r3 = a[[1], :]  # 用[1]也不降维
print(row_r1, row_r1.shape)
print(row_r2, row_r2.shape)
print(row_r3, row_r3.shape)
# [5 6 7 8] (4,)
# [[5 6 7 8]] (1, 4)
# [[5 6 7 8]] (1, 4)
</code></pre>
<p>切片操作得到的永远是原来 array 的 subarray，如果我想重组怎么办呢？比如 [[1, 2], [3, 4]] 我想得到 [[3, 4], [1, 2], [1, 2]]，可以使用 <strong>integer array indexing</strong>：</p>
<pre><code class="language-python">a = np.array([[1, 2], [3, 4]])
b = a[[1, 0, 0], [0, 1]]
# b是[[3, 4], [1, 2], [1, 2]]，即a的第1行、第0行、第0行拼接
</code></pre>
<p><strong>boolean array indexing</strong> 很强大，允许我们进行筛选：</p>
<pre><code class="language-python">a = np.array([[1,2], [3, 4], [5, 6]])

bool_idx = (a &gt; 2)  # Find the elements of a that are bigger than 2;
                    # this returns a numpy array of Booleans of the same
                    # shape as a, where each slot of bool_idx tells
                    # whether that element of a is &gt; 2.
# [[False False]
# [ True  True]
# [ True  True]]

# We use boolean array indexing to construct a rank 1 array
# consisting of the elements of a corresponding to the True values
# of bool_idx
print(a[bool_idx])

# We can do all of the above in a single concise statement:
print(a[a &gt; 2])

# [3 4 5 6]
# [3 4 5 6]
</code></pre>
<h3 id="pandas">pandas</h3>
<pre><code class="language-python">import pandas as pd

# 读取excel，第0个sheet
df = pd.read_excel('./filename.xlsx', 0)

# 获取行数、列数
nrow = df.shape[0]
ncol = df.shape[1]

### 切片、筛选、提取数据 ###

# 直接通过'[]'，字符串表示列，数字表示行
df['price']       				# 选取名字为'price'的列
df[['name', 'price']]			# 选取多列，把列名放在list里
df[:2]							# 第0行和第1行，这里和list的切片操作一样

# iloc和loc：索引用iloc，列名用loc。iloc和loc的优势是可以进行筛选
# loc用法：df.loc[index, column_name]
# 一个大坑：loc的行索引是闭区间，而不是python通用的左闭右开（但iloc是正常的）
df.loc[2, 'price']				# 第2行，名字为'price'的列
df.loc[[2,3],['name','price']]  # index和column_name都可灵活使用list或切片
df.loc[df['price']&lt;100,'name']  # 筛选，注意筛选条件是针对行的

# iloc用法：只要把loc的列名改成索引
df.iloc[df['price']&lt;100, 2:5]   # 一样可以灵活组合list和切片
df.iloc[df['price']&lt;100 | df['price']&gt;200]  # 筛选条件'|'表示或，'&amp;'表示与
</code></pre>
<h3 id="sklearn">sklearn</h3>
<pre><code class="language-python"># 线性回归
from sklearn import linear_model
# 训练数据：X_train, y_train，测试数据：X_test
lm = linear_model.LinearRegression()
model = lm.fit(X_train, y_train)
y_pred = model.predict(X_test)

# 交叉验证
from sklearn.model_selection import cross_val_score
cross_val_score(m, X, y, cv=5, scoring='neg_mean_squared_error') # 5-fold cross validation, m是sklearn的model
</code></pre>
<h2 id="数据结构">数据结构</h2>
<h3 id="heapq">heapq</h3>
<pre><code class="language-python">import heapq as hq

# python的heapq库是在list的基础上添加了堆的操作
# heapq有两种方式创建堆，一种是使用一个空列表，然后使用heapq.heappush()函数把值加入堆中
num = [1,1,4,5,1,4]
heapq.heappush(heap, num)
# 另外一种就是使用heapq.heapify(list)转换列表成为堆结构
heapq.heapify(num)       # 这时候num也变成堆了
</code></pre>
<h2 id="网络爬虫相关">网络/爬虫相关</h2>
<h3 id="requests">requests</h3>
<pre><code class="language-python">import requests

# get请求
html = requests.get('www.baidu.com').text

# get请求可以优雅地加参数
params = {'q': '搜索测试'}
response = requests.get(url='www.google.com/search', params=params).text
</code></pre>
<h3 id="beautifulsoup">BeautifulSoup</h3>
<pre><code class="language-python">from bs4 import BeautifulSoup

# 之前用request获取html

bs = BeautifulSoup(html, 'html.parser')

# 查找标签，返回标签html字符串的list
p_list = bs.findAll('p')						# 查找所有&lt;p&gt;标签
div_list = bs.findAll('div', attrs={'class': 'primary'})		# 带条件筛选&lt;div class='primary'&gt;
# 条件可以是正则表达式
a_list = bs.findAll('a', string='[abs]')		# 字符串包含[abs]
</code></pre>
<h3 id="json">json</h3>
<pre><code class="language-python">import json
import requests

data = requests.get('www.baidu.com').content.decode()	# 某请求返回的字符串格式的json

# 字符串转json
data_js = json.loads(data)
</code></pre>
    </div>
</article>




            </div>
            <aside class="col-12 col-md-3 float-left sidebar">
    
    <div class="sidebar-item sidebar-pages">
        <h3>页面</h3>
        <ul>
            
            <li>
                <a href="/">主页</a>
            </li>
            
            <li>
                <a href="/archives/">文章</a>
            </li>
            
            <li>
                <a href="/about/">关于</a>
            </li>
            
            <li>
                <a href="/search/">搜索</a>
            </li>
            
        </ul>
    </div>
    
    <div class="sidebar-item sidebar-links">
        <h3>链接</h3>
        <ul>
            
            <li>
                <a href="https://github.com/jcq15" target="_blank"><span>GitHub</span></a>
            </li>
            
        </ul>
    </div>
    
    <div class="sidebar-item sidebar-tags">
        <h3>标签</h3>
        <div>
            
            <span>
                <a href="/tags/%E5%AD%A6%E4%B9%A0/">学习</a>
            </span>
            
            <span>
                <a href="/tags/%E6%8A%80%E6%9C%AF/">技术</a>
            </span>
            
            <span>
                <a href="/tags/%E6%B2%99%E9%9B%95/">沙雕</a>
            </span>
            
            <span>
                <a href="/tags/%E6%B8%B8%E6%88%8F/">游戏</a>
            </span>
            
        </div>
    </div>
    <div class="sidebar-item sidebar-toc">
        <h3>目录</h3><nav id="TableOfContents">
  <ul>
    <li><a href="#实用工具">实用工具</a>
      <ul>
        <li><a href="#datetime">datetime</a></li>
      </ul>
    </li>
    <li><a href="#数据处理">数据处理</a>
      <ul>
        <li><a href="#numpy">numpy</a></li>
        <li><a href="#pandas">pandas</a></li>
        <li><a href="#sklearn">sklearn</a></li>
      </ul>
    </li>
    <li><a href="#数据结构">数据结构</a>
      <ul>
        <li><a href="#heapq">heapq</a></li>
      </ul>
    </li>
    <li><a href="#网络爬虫相关">网络/爬虫相关</a>
      <ul>
        <li><a href="#requests">requests</a></li>
        <li><a href="#beautifulsoup">BeautifulSoup</a></li>
        <li><a href="#json">json</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
</aside>
        </div>
        <div class="btn">
    <div class="btn-menu" id="btn-menu">
        <i class="iconfont icon-grid-sharp"></i>
    </div>
    <div class="btn-toggle-mode">
        <i class="iconfont icon-contrast-sharp"></i>
    </div>
    <div class="btn-scroll-top">
        <i class="iconfont icon-chevron-up-circle-sharp"></i>
    </div>
</div>
<aside class="sidebar-mobile" style="display: none;">
  <div class="sidebar-wrapper">
    
    <div class="sidebar-item sidebar-pages">
        <h3>页面</h3>
        <ul>
            
            <li>
                <a href="/">主页</a>
            </li>
            
            <li>
                <a href="/archives/">文章</a>
            </li>
            
            <li>
                <a href="/about/">关于</a>
            </li>
            
            <li>
                <a href="/search/">搜索</a>
            </li>
            
        </ul>
    </div>
    
    <div class="sidebar-item sidebar-links">
        <h3>链接</h3>
        <ul>
            
            <li>
                <a href="https://github.com/jcq15" target="_blank"><span>GitHub</span></a>
            </li>
            
        </ul>
    </div>
    
    <div class="sidebar-item sidebar-tags">
        <h3>标签</h3>
        <div>
            
            <span>
                <a href="/tags/%E5%AD%A6%E4%B9%A0/">学习</a>
            </span>
            
            <span>
                <a href="/tags/%E6%8A%80%E6%9C%AF/">技术</a>
            </span>
            
            <span>
                <a href="/tags/%E6%B2%99%E9%9B%95/">沙雕</a>
            </span>
            
            <span>
                <a href="/tags/%E6%B8%B8%E6%88%8F/">游戏</a>
            </span>
            
        </div>
    </div>
    
    
    
    <div class="sidebar-item sidebar-toc">
        <h3>目录</h3>
        <nav id="TableOfContents">
  <ul>
    <li><a href="#实用工具">实用工具</a>
      <ul>
        <li><a href="#datetime">datetime</a></li>
      </ul>
    </li>
    <li><a href="#数据处理">数据处理</a>
      <ul>
        <li><a href="#numpy">numpy</a></li>
        <li><a href="#pandas">pandas</a></li>
        <li><a href="#sklearn">sklearn</a></li>
      </ul>
    </li>
    <li><a href="#数据结构">数据结构</a>
      <ul>
        <li><a href="#heapq">heapq</a></li>
      </ul>
    </li>
    <li><a href="#网络爬虫相关">网络/爬虫相关</a>
      <ul>
        <li><a href="#requests">requests</a></li>
        <li><a href="#beautifulsoup">BeautifulSoup</a></li>
        <li><a href="#json">json</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
    
    
  </div>
</aside>
    </main>

    <footer>
    
    <div class="container-lg clearfix">
        <div class="col-12 footer">
            
            <p>
                除特殊注明部分，本站内容采用 <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 进行许可。
            </p>
            
            <span>&copy; 2021-2021
                <a href="https://blog.shadiao.online">精神病人</a>
                 | <a href="https://github.com/jcq15/blog">Source code</a> 
                | 基于 <a href="https://github.com/dsrkafuu/hugo-theme-fuji/"
                   target="_blank">Fuji-v2</a> &amp; <a href="https://gohugo.io/"
                                                    target="_blank">Hugo</a> 构建
            </span>
        </div>
    </div>
</footer>

    
<script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.0/lazysizes.min.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/components/prism-core.min.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/autoloader/prism-autoloader.min.js"></script>



<script defer src="/assets/js/fuji.min.js"></script>


</body>

</html>